<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CleanAir Tracker</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* ===== Reset ===== */
    * { margin: 0; padding: 0; box-sizing: border-box; }

    /* ========= Page styling (high-contrast / modern) ========= */
    body {
      font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(135deg, #f0f4ff 0%, #ffffff 100%);
      min-height: 100vh;
      color: #1e293b;
      line-height: 1.6;
    }

    header {
      background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
      color: white;
      padding: 4rem 2rem;
      text-align: center;
      box-shadow: 0 8px 32px rgba(0,0,0,0.08);
      border-bottom: 1px solid rgba(255,255,255,0.12);
    }
    header h1 {
      font-family: 'Poppins', sans-serif;
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }
    header p { font-size: 1.05rem; opacity: 0.92; }

    .container { max-width: 1100px; margin: 0 auto; padding: 2rem; }

    section {
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(8px);
      padding: 2rem;
      margin: 1.75rem auto;
      border-radius: 16px;
      box-shadow:
        0 18px 22px -10px rgba(0,0,0,0.06),
        0 8px 10px -8px rgba(0,0,0,0.04);
      border: 1px solid #e6eefc;
      color: #1e293b;
    }

    section h2 {
      font-family: 'Poppins', sans-serif;
      font-size: 1.6rem;
      color: #1e40af;
      margin-bottom: 1rem;
      padding-left: 0.6rem;
      position: relative;
    }
    section h2::before {
      content: "";
      position: absolute;
      left: 0;
      top: 0.3rem;
      bottom: 0.3rem;
      width: 4px;
      background: linear-gradient(135deg, #60a5fa, #1d4ed8);
      border-radius: 2px;
    }

    /* Search box */
    .search-box {
      margin: 1.25rem auto;
      text-align: center;
      padding: 1.5rem;
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 14px;
      max-width: 720px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.04);
    }
    .input-group { display:flex; gap:1rem; max-width:640px; margin:0 auto; align-items:center; }
    .search-box select {
      flex:1;
      padding: 0.9rem 1rem;
      border-radius: 10px;
      border: 1px solid #cbd5e1;
      font-size: 1rem;
      background: #fff;
      color: #0f172a;
      outline: none;
    }
    .search-box button {
      padding: 0.9rem 1.25rem;
      border-radius: 10px;
      border: none;
      background: linear-gradient(135deg,#3b82f6,#1d4ed8);
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      transition: all .18s ease;
    }
    .search-box button:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(59,130,246,0.18); }

    /* Precautions output */
    #precautions-output {
      margin-top: 1.25rem;
      padding: 1.4rem;
      background: #f1f5f9;
      border: 1px solid #cbd5e1;
      border-radius: 12px;
      display: none;
      color: #0f172a;
    }
    #precautions-output h3 { color: #0f172a; margin-bottom: 0.5rem; font-family: 'Poppins', sans-serif; }
    #precautions-output ul { list-style: none; padding-left: 0; }
    #precautions-output li {
      padding: 0.6rem 0;
      padding-left: 1.5rem;
      position: relative;
      border-bottom: 1px solid #e6eefc;
    }
    #precautions-output li:last-child { border-bottom: none; }
    #precautions-output li::before {
      content: 'â€¢';
      color: #3b82f6;
      font-size: 1.1rem;
      position: absolute;
      left: 0;
      top: 0.1rem;
    }

    /* Tips box */
    #tips-box {
      margin-top: 1.25rem;
      padding: 1.4rem;
      background: #fff7ed;
      border: 1px solid #fcd34d;
      border-radius: 12px;
      color: #92400e;
    }
    #tips-box h3 { font-family:'Poppins',sans-serif; font-size:1.1rem; color:#b45309; margin-bottom:0.6rem; }
    #tip-box { transition: opacity .5s ease; min-height: 48px; font-weight:500; }

    footer {
      text-align:center;
      padding: 2rem;
      background: #f1f5f9;
      color: #475569;
      border-top: 1px solid #e6eefc;
      margin-top: 2rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
      header h1 { font-size: 2rem; }
      .input-group { flex-direction: column; gap:0.75rem; }
      .search-box select { width: 100%; }
      .search-box button { width: 100%; margin-left: 0; }
    }
  </style>
</head>
<body>

<header>
  <h1>CleanAir Tracker</h1>
  <p>Stay Informed. Breathe Better. Live Smarter.</p>
</header>

<div class="container">
  <section>
    <h2>Search City Precautions</h2>

    <div class="search-box">
      <div class="input-group">
        <select id="location-input">
          <option value="">Select a city</option>
          <option value="Agartala">Agartala</option>
          <option value="Agra">Agra</option>
          <option value="Aizawl">Aizawl</option>
          <option value="Bengaluru">Bengaluru</option>
          <option value="Bhopal">Bhopal</option>
          <option value="Bhubaneswar">Bhubaneswar</option>
          <option value="Chandigarh">Chandigarh</option>
          <option value="Chennai">Chennai</option>
          <option value="Dehradun">Dehradun</option>
          <option value="Dispur">Dispur</option>
          <option value="Gangtok">Gangtok</option>
          <option value="Gandhinagar">Gandhinagar</option>
          <option value="Hyderabad">Hyderabad</option>
          <option value="Itanagar">Itanagar</option>
          <option value="Jaipur">Jaipur</option>
          <option value="Jammu">Jammu</option>
          <option value="Kohima">Kohima</option>
          <option value="Kolkata">Kolkata</option>
          <option value="Lucknow">Lucknow</option>
          <option value="Mumbai">Mumbai</option>
          <option value="Panaji">Panaji</option>
          <option value="Patna">Patna</option>
          <option value="Raipur">Raipur</option>
          <option value="Ranchi">Ranchi</option>
          <option value="Shillong">Shillong</option>
          <option value="Shimla">Shimla</option>
          <option value="Srinagar">Srinagar</option>
          <option value="Thiruvananthapuram">Thiruvananthapuram</option>
        </select>
        <button onclick="showPrecautions()">Search</button>
      </div>
    </div>

    <div id="precautions-output"></div>

    <div id="tips-box">
      <h3>ðŸ’¡ Did You Know?</h3>
      <p id="tip-box">Loading tip...</p>
    </div>
  </section>

  <!-- About -->
  <section>
    <h2>About the Project</h2>
    <p>CleanAir Tracker is a solution to monitor air pollution trends and provide users with localized health precautions based on air quality conditions in urban environments. The goal is to raise awareness, encourage behavioral change, and reduce health risks associated with poor air quality.</p>
  </section>

  <!-- Mission -->
  <section>
    <h2>Our Mission</h2>
    <p>To empower individuals and communities with accessible, location-based air quality insights and safety recommendationsâ€”so everyone can make informed, healthy choices every day.</p>
  </section>

  <!-- Key Features -->
  <section>
    <h2>Key Features</h2>
    <ul>
      <li>Live AQI data fetched from trusted sources.</li>
      <li>Dynamic health precautions based on AQI levels.</li>
      <li>Fallback to pre-stored city data when live data is unavailable.</li>
      <li>Daily rotating air quality tips.</li>
      <li>Mobile-friendly and responsive design.</li>
    </ul>
  </section>

  <!-- Development Stage -->
  <section>
    <h2>Development Stage</h2>
    <p>The project is currently in beta, with ongoing improvements to data coverage, real-time alerts, and interactive features.</p>
  </section>

  <!-- Support & Collaboration -->
  <section>
    <h2>Support & Collaboration</h2>
    <p>We welcome feedback, contributions, and collaboration from developers, researchers, and environmentally conscious communities. Together we can make urban air healthier and safer.</p>
  </section>

</div>

<footer>
  &copy; 2025 CleanAir Tracker. All Rights Reserved.
</footer>

<script>
  // ===== Local fallback data =====
  const localData = {
    "Agartala": { aqi: 0, precautions: ["Fallback precaution"] },
    "Agra": { aqi: 0, precautions: ["Fallback precaution"] },
    "Aizawl": { aqi: 0, precautions: ["Fallback precaution"] },
    "Bengaluru": { aqi: 0, precautions: ["Fallback precaution"] },
    "Bhopal": { aqi: 0, precautions: ["Fallback precaution"] },
    "Bhubaneswar": { aqi: 0, precautions: ["Fallback precaution"] },
    "Chandigarh": { aqi: 0, precautions: ["Fallback precaution"] },
    "Chennai": { aqi: 0, precautions: ["Fallback precaution"] },
    "Dehradun": { aqi: 0, precautions: ["Fallback precaution"] },
    "Dispur": { aqi: 0, precautions: ["Fallback precaution"] },
    "Gangtok": { aqi: 0, precautions: ["Fallback precaution"] },
    "Gandhinagar": { aqi: 0, precautions: ["Fallback precaution"] },
    "Hyderabad": { aqi: 0, precautions: ["Fallback precaution"] },
    "Itanagar": { aqi: 0, precautions: ["Fallback precaution"] },
    "Jaipur": { aqi: 0, precautions: ["Fallback precaution"] },
    "Jammu": { aqi: 0, precautions: ["Fallback precaution"] },
    "Kohima": { aqi: 0, precautions: ["Fallback precaution"] },
    "Kolkata": { aqi: 0, precautions: ["Fallback precaution"] },
    "Lucknow": { aqi: 0, precautions: ["Fallback precaution"] },
    "Mumbai": { aqi: 0, precautions: ["Fallback precaution"] },
    "Panaji": { aqi: 0, precautions: ["Fallback precaution"] },
    "Patna": { aqi: 0, precautions: ["Fallback precaution"] },
    "Raipur": { aqi: 0, precautions: ["Fallback precaution"] },
    "Ranchi": { aqi: 0, precautions: ["Fallback precaution"] },
    "Shillong": { aqi: 0, precautions: ["Fallback precaution"] },
    "Shimla": { aqi: 0, precautions: ["Fallback precaution"] },
    "Srinagar": { aqi: 0, precautions: ["Fallback precaution"] },
    "Thiruvananthapuram": { aqi: 0, precautions: ["Fallback precaution"] }
  };

  async function showPrecautions() {
    const location = document.getElementById("location-input").value;
    const outputDiv = document.getElementById("precautions-output");
    if(!location) { outputDiv.innerHTML = "<strong>Please select a city.</strong>"; outputDiv.style.display="block"; return; }

    try {
      // Live fetch
      // Instead of calling the external API directly:
      const resp = await fetch(`/api/aqi?city=${encodeURIComponent(location)}`);
      const data = await resp.json();

      // WAQI gives AQI at data.data.aqi
      let aqi = data.data.aqi || 0;

      if(cityData && cityData.measurements && cityData.measurements.length>0){
        const measurement = cityData.measurements.find(m=>m.parameter==="pm25") || cityData.measurements[0];
        aqi = measurement.value;
      } else {
        cityData = { city: location };
        aqi = localData[location].aqi;
      }

      let aqiLevel="", aqiColor="";
      if(aqi<=50){ aqiLevel="Good"; aqiColor="green"; }
      else if(aqi<=100){ aqiLevel="Moderate"; aqiColor="#f59e0b"; }
      else if(aqi<=150){ aqiLevel="Unhealthy for Sensitive Groups"; aqiColor="orange"; }
      else if(aqi<=200){ aqiLevel="Unhealthy"; aqiColor="red"; }
      else if(aqi<=300){ aqiLevel="Very Unhealthy"; aqiColor="purple"; }
      else{ aqiLevel="Hazardous"; aqiColor="maroon"; }

      let precautions = localData[location].precautions.slice();
      if(aqi>0){
        if(aqi<=50){ precautions=["Enjoy outdoor activities freely."]; }
        else if(aqi<=100){ precautions=["Sensitive groups should limit long outdoor exertion."]; }
        else if(aqi<=150){ precautions=["Children, elderly, and asthma patients should wear masks outdoors.","Avoid jogging near traffic-heavy areas."]; }
        else if(aqi<=200){ precautions=["Limit outdoor exposure.","Wear an N95 mask outside.","Use indoor air purifiers."]; }
        else if(aqi<=300){ precautions=["Stay indoors as much as possible.","Keep windows closed.","Avoid physical activity outdoors."]; }
        else{ precautions=["Emergency situation: Avoid going outside.","Sensitive groups should relocate if possible."]; }
      }

      outputDiv.innerHTML = `<h3>Live AQI for ${cityData.city}:</h3>
        <p><strong>AQI:</strong> <span style="color:${aqiColor}; font-weight:bold;">${aqi} (${aqiLevel})</span></p>
        <ul>${precautions.map(p=>`<li>${p}</li>`).join("")}</ul>`;
    } catch(e){
      console.error(e);
      const fallback = localData[location] || {aqi:0,precautions:["No data"]};
      outputDiv.innerHTML = `<h3>Live data not found. Showing fallback:</h3>
        <p><strong>AQI:</strong> ${fallback.aqi}</p>
        <ul>${fallback.precautions.map(p=>`<li>${p}</li>`).join("")}</ul>`;
    }
    outputDiv.style.display="block";
  }

  // ===== Tips =====
  const tips=["Indoor plants like peace lilies, spider plants, and snake plants can help improve air quality by absorbing pollutants.","Switching to public transport can cut your personal carbon footprint by up to 30%.","Keeping windows closed during high pollution days helps reduce indoor exposure.","Staying hydrated helps your body flush out pollution-related toxins.","Air purifiers with HEPA filters can reduce indoor pollutants like dust, pollen, and smoke.","Carpooling with friends or colleagues reduces both traffic congestion and air pollution.","Burning candles and incense indoors can significantly worsen indoor air quality.","Using an exhaust fan while cooking helps remove harmful gases like nitrogen dioxide.","Electric vehicles produce zero tailpipe emissions, improving urban air quality.","Household dust can carry pollutantsâ€”regular vacuuming with a HEPA filter helps reduce it.","Children and the elderly are more vulnerable to poor air qualityâ€”extra precautions are important.","Reducing meat consumption can lower methane and greenhouse gas emissions linked to livestock farming.","Pollution levels are usually lower after heavy rainfall, as rain washes particulates from the air.","Smog tends to be worst on sunny, hot days when pollutants react with sunlight.","Switching to energy-efficient appliances reduces emissions from power plants.","Volatile Organic Compounds (VOCs) from paints and cleaners contribute to indoor air pollution.","Second-hand smoke releases hundreds of toxic chemicals into the air, even indoors.","Short trips pollute the mostâ€”walking or cycling for local errands makes a big difference.","Idling your car engine for more than 10 seconds wastes fuel and adds unnecessary pollution.","Air quality often improves significantly in early mornings and late nights due to lower traffic.","Trees not only provide oxygen but also trap dust and absorb harmful gases.","Avoid using diesel generators whenever possibleâ€”they release large amounts of particulate matter.","Switching to renewable energy sources like solar and wind improves both climate and air quality.","Poor ventilation indoors can trap pollutantsâ€”open windows on low-pollution days.","Air quality inside vehicles can sometimes be worse than outside due to trapped emissions.","Wood-burning stoves release fine particulate matter, which can be harmful to lungs.","High-efficiency furnace and AC filters help trap indoor air pollutants.","Walking on quieter side streets can reduce your pollution exposure by up to 60%.","Fine particles (PM2.5) are so small they can enter the bloodstream through your lungs."];
  let usedTips=[],currentTip="";
  function getRandomTip(){if(usedTips.length===tips.length)usedTips=[];let newTip;do{newTip=tips[Math.floor(Math.random()*tips.length)];}while(newTip===currentTip||usedTips.includes(newTip));usedTips.push(newTip);currentTip=newTip;return newTip;}
  function showNextTip(){const tipBox=document.getElementById("tip-box");if(!tipBox)return;tipBox.style.opacity=0;setTimeout(()=>{tipBox.textContent=getRandomTip();tipBox.style.opacity=1;},300);}
  window.addEventListener("DOMContentLoaded",()=>{showNextTip();setInterval(showNextTip,10000);});
</script>

</body>
</html>
